<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Traductor de Alarmas</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 50px;
      position: relative;
    }
    .form-control {
      padding: 10px;
      font-size: 16px;
      width: 100%;
      margin-bottom: 10px;
      box-sizing: border-box;
    }
    .button-principal {
      background-color: #007BFF;
      color: white;
      border: none;
      cursor: pointer;
      transition: background-color 0.3s ease;
      border-radius: 6px;
      padding: 12px;
      font-size: 16px;
      font-weight: bold;
    }
    .button-principal:hover {
      background-color: #0056b3;
    }
    #resultado-container {
      margin-top: 20px;
    }
    #resultado {
      font-weight: bold;
      white-space: pre-wrap;
    }
    #resumenVisual {
      margin-top: 10px;
      font-size: 14px;
      color: #333;
    }
    #resumenVisual span {
      display: block;
      margin: 3px 0;
    }
    #historial-container {
      margin-top: 30px;
      font-size: 13px;
      color: #777;
      background-color: #f9f9f9;
      padding: 10px;
      border-top: 1px dashed #ccc;
      display: none;
    }
    #historial-container h3 {
      font-size: 14px;
      font-weight: normal;
      margin-bottom: 5px;
      color: #999;
    }
    #listaHistorial {
      list-style: none;
      padding-left: 0;
    }
    #listaHistorial li {
      padding: 2px 0;
      border-bottom: 1px dotted #ccc;
      font-size: 13px;
    }
    .marca {
      position: fixed;
      bottom: 10px;
      right: 20px;
      font-size: 12px;
      color: #999;
    }
    .toggle-historial {
      background-color: #f0f0f0;
      border: none;
      font-size: 13px;
      color: #555;
      margin-top: 20px;
      cursor: pointer;
      text-decoration: underline;
    }
    h1 {
      text-align: center;
      text-transform: uppercase;
    }
    label {
      font-weight: bold;
    }
  </style>
</head>
<body>
  <h1>Traductor de Alarmas</h1>
  <textarea id="alarmaInput" class="form-control" rows="5" placeholder="Pegue aqu√≠ la l√≠nea completa con campos separados por tabulaci√≥n"></textarea>

  <label for="afectacion">Tipo de afectaci√≥n:</label>
  <select id="afectacion" class="form-control">
    <option value="AFECTACI√ìN POTENCIAL">AFECTACI√ìN POTENCIAL</option>
    <option value="DEGRADACI√ìN">DEGRADACI√ìN</option>
    <option value="INDISPONIBILIDAD">INDISPONIBILIDAD</option>
    <option value="SIN AFECTACI√ìN">SIN AFECTACI√ìN</option>
  </select>

  <label for="grupo">Grupo asignado:</label>
  <select id="grupo" class="form-control">
    <option value="VOZMOVIL">PCS Voz M√≥vil</option>
    <option value="VOZRESI">PCS Voz Fija</option>
    <option value="ROAMINT">PCS Roaming Internacional</option>
    <option value="VALORAGR">PCS Serv. Convergentes</option>
    <option value="VIRTINFR">PCS Infra&Net</option>
    <option value="NAVMOVIL">PCS Conectividad Afuera</option>
    <option value="VOZMOVL">PCS Se√±alizaci√≥n y BD</option>
  </select>

  <label for="origen">Origen del reclamo:</label>
  <select id="origen" class="form-control">
    <option value="MAE_CORE">MAE Core</option>
    <option value="SOLICITUD">SOLICITUD</option>
    <option value="GRAFANA">GRAFANA</option>
    <option value="SMARTCARE">SMARTCARE</option>
    </select>
    
  <button class="form-control button-principal" onclick="procesarAlarma()">Generar descripci√≥n</button>
  <div id="resultado-container">
    <span id="resultado"></span>
  </div>
  <div id="resumenVisual"></div>

  <button class="toggle-historial" onclick="alternarHistorial()">Mostrar/Ocultar historial</button>
  <div id="historial-container">
    <h3>Historial de consultas anteriores</h3>
    <ul id="listaHistorial"></ul>
  </div>

  <div class="marca">NOC-MO ¬∑ 2025</div>

  <script>
    const alarmas = {
      "etcd Backup Failed": "Falla en el respaldo de la base de datos distribuida etcd.",
      "Disk Usage High": "El uso del disco est√° por encima del umbral.",
      "CPU Load High": "Alta carga de CPU detectada.",
      "Link Down": "Se detect√≥ que un enlace de red est√° ca√≠do.",
      "Memory Utilization Critical": "Utilizaci√≥n de memoria en nivel cr√≠tico.",
      "hwIfMonitorCrcErrorRising": "Interfaz con errores.",
      "CORE Delta 3G Mode Average Attached Users x USN": "Promedio de usuarios adjuntos en USN 3G fuera de valores esperados."
    };

    const gruposMap = {
      "PCS Voz M√≥vil": "VOZMOVIL",
      "PCS Voz Fija": "VOZRESI",
      "PCS Roaming Internacional": "ROAMINT",
      "PCS Serv. Convergentes": "VALORAGR",
      "PCS Infra&Net": "VIRTINFR",
      "PCS Conectividad Afuera": "NAVMOVIL",
      "PCS Se√±alizaci√≥n y BD": "VOZMOVL",
      "NOC-MO": "NOC-MO",
      "NOC-AC": "NOC-AC",
      "NOC-TR": "NOC-TR",
      "CSOT": "NCSN-CAO"
    };

    const afectacionMap = {
      "AFECTACI√ìN POTENCIAL": "AFECTACI√ìN POTENCIAL",
      "DEGRADACI√ìN": "DEGRADACI√ìN",
      "INDISPONIBILIDAD": "INDISPONIBILIDAD",
      "SIN AFECTACI√ìN": "SIN AFECTACI√ìN"
    };

    const historial = [];

    function procesarAlarma() {
      const entrada = document.getElementById("alarmaInput").value;
      const campos = entrada.split('\t');

      const node = campos[52] || "Nodo vac√≠o o err√≥neo";
      const alertaOriginal = campos[53] || "Alerta vac√≠a o err√≥nea";
      const alertaTraducida = alarmas[alertaOriginal] || alertaOriginal;

      const afectacionCode = document.getElementById("afectacion").value;
      const grupoLabel = document.getElementById("grupo").selectedOptions[0].text;
      const grupoCode = document.getElementById("grupo").value
      const origenCode = document.getElementById("origen").value; // Obtenemos el valor del origen del reclamo
      const origenLabel = document.getElementById("origen").selectedOptions[0].text; // Obtenemos la etiqueta del origen
;

      const descripcion = `NOC-MO | ${node} | ${alertaTraducida} | ${afectacionCode} | ${grupoCode} | ${origenCode}`;
      document.getElementById("resultado").innerText = descripcion;

      const resumen = document.getElementById("resumenVisual");
      resumen.innerHTML = `
        <span>üìç Nodo: <strong>${node}</strong></span>
        <span>üö® Alarma: <strong>${alertaTraducida}</strong></span>
        <span>‚ö†Ô∏è Tipo de afectaci√≥n: <strong>${afectacionMap[afectacionCode]}</strong></span>
        <span>üß© Grupo asignado: <strong>${grupoLabel}</strong></span>
        <span>üì¢ Origen del reclamo: <strong>${origenLabel}</strong></span>
      `;

      historial.push({ entrada: alertaOriginal, resultado: descripcion });
      actualizarHistorial();
      
      // Copiar al portapapeles
      navigator.clipboard.writeText(descripcion)
        .then(() => {
        mostrarMensajeCopiado();
        })
      .catch(err => console.error('Error al copiar al portapapeles:', err));
    }

    function actualizarHistorial() {
      const lista = document.getElementById("listaHistorial");
      lista.innerHTML = "";
      historial.forEach((item, index) => {
        const li = document.createElement("li");
        li.textContent = `${index + 1}. [${item.entrada}] ‚Üí ${item.resultado}`;
        lista.appendChild(li);
      });
    }

    function alternarHistorial() {
      const contenedor = document.getElementById("historial-container");
      contenedor.style.display = contenedor.style.display === "none" ? "block" : "none";
    }

    function mostrarMensajeCopiado() {
  let mensaje = document.getElementById("mensajeCopiado");
  if (!mensaje) {
    mensaje = document.createElement("div");
    mensaje.id = "mensajeCopiado";
    mensaje.style.position = "fixed";
    mensaje.style.bottom = "20px";
    mensaje.style.left = "50%";
    mensaje.style.transform = "translateX(-50%)";
    mensaje.style.backgroundColor = "#28a745";
    mensaje.style.color = "white";
    mensaje.style.padding = "10px 20px";
    mensaje.style.borderRadius = "8px";
    mensaje.style.boxShadow = "0px 0px 10px rgba(0,0,0,0.2)";
    mensaje.style.zIndex = "1000";
    document.body.appendChild(mensaje);
  }

  mensaje.textContent = "üìã Texto copiado al portapapeles";
  mensaje.style.display = "block";

  setTimeout(() => {
    mensaje.style.display = "none";
  }, 2500);
}
  </script>
</body>
</html>

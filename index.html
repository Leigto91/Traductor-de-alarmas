<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Traductor de Alarmas</title>
  <style>
    :root {
        --color-primary: #007bff; /* Azul vibrante para elementos principales */
        --color-primary-dark: #0056b3; /* Azul m√°s oscuro para hover */
        --color-secondary: #dc3545; /* Rojo para limpiar */
        --color-secondary-dark: #c82333; /* Rojo m√°s oscuro para hover */
        --color-success: #28a745; /* Verde para guardar nota */
        --color-success-dark: #1e7e34; /* Verde m√°s oscuro para hover */
        --color-background-light: #f4f6f8; /* Gris claro de fondo general */
        --color-background-medium: #e9ecef; /* Gris medio para contenedores */
        --color-background-dark: #f8f9fa; /* Otro gris claro para secciones */
        --color-text-dark: #212529; /* Texto muy oscuro (casi negro) */
        --color-text-medium: #495057; /* Texto medio (gris oscuro) */
        --color-text-light: #6c757d; /* Texto m√°s claro */
        --color-border: #ddd; /* Color de bordes suaves */
        --color-shadow: rgba(0, 0, 0, 0.1); /* Sombra est√°ndar */
        --color-shadow-light: rgba(0, 0, 0, 0.05); /* Sombra m√°s suave */
        --color-white: #fff; /* Blanco puro */
    }

     
 
</head>
    body {
    font-family: 'Segoe UI', 'Helvetica Neue', Arial, sans-serif; /* PEQUE√ëO AJUSTE EN LA FUENTE */
    font-size: 15px; /* NUEVO: Tama√±o de fuente base */
    color: var(--color-text-dark); /* NUEVO: Usar variable para el color de texto general */
    background-color: var(--color-background-light); /* USANDO VARIABLE */
    margin: 0;
    padding: 5px;
    line-height: 1.6;
}

.container {
    max-width: 95%;
    margin: 5px auto;
    display: grid;
    grid-template-columns: 6fr 4fr;
    gap: 20px; /* AJUSTADO: M√°s espacio entre columnas y filas */
    background-color: var(--color-white); /* USANDO VARIABLE */
    padding: 20px; /* AJUSTADO: M√°s padding interno */
    border-radius: 8px; /* AJUSTADO: Bordes m√°s suaves */
    box-shadow: 0 4px 12px var(--color-shadow); /* AJUSTADO: Sombra m√°s pronunciada y suave */
}

/* --- Estilos para la firma y el h1 principal --- */
.signature-line {
  display: block; /* Para que ocupe su propia l√≠nea dentro del div */
  text-align: center; /* Centra la firma dentro del div full-width */
  font-size: 16px;
  color: #495057;
  margin-top: 0;
  margin-bottom: 5px;
  opacity: 0.7;
  font-weight: 600;
}

h1 {
    text-align: center;
    text-transform: none;
    /* grid-column: span 2; Ya no es necesario aqu√≠ porque el contenedor padre es full-width */
    font-size: 28px;
    color: var(--color-primary); /* USANDO VARIABLE */
    margin-bottom: 25px;
    font-weight: 500;
}
/* --- Fin de estilos --- */

.form-control, textarea, select {
    padding: 12px; /* AJUSTADO: M√°s padding */
    font-size: 15px;
    width: 100%; /* AJUSTADO: Elimina calc(100% - 20px) si ya tienes box-sizing: border-box; */
    box-sizing: border-box;
    margin-bottom: 15px; /* AJUSTADO: M√°s espacio entre ellos */
    border: 1px solid var(--color-border); /* USANDO VARIABLE */
    border-radius: 6px; /* AJUSTADO: Bordes un poco m√°s redondeados */
    transition: border-color 0.2s ease-in-out, box-shadow 0.2s ease-in-out; /* NUEVO: Transici√≥n suave al focus */
}
/* NUEVO: Estilos para el focus de inputs */
.form-control:focus, textarea:focus, select:focus {
    outline: none; /* Eliminar el contorno por defecto del navegador */
    border-color: var(--color-primary); /* Borde azul al enfocar */
    box-shadow: 0 0 0 3px rgba(0, 123, 255, 0.25); /* Sombra suave azul al enfocar */
}

label {
    font-weight: 600; /* AJUSTADO: Un poco m√°s bold */
    display: block;
    margin-bottom: 10px; /* AJUSTADO: M√°s espacio debajo de la label */
    font-size: 14px;
    color: var(--color-text-medium); /* USANDO VARIABLE */
}

.form-group {
    margin-bottom: 20px; /* AJUSTADO: M√°s espacio entre grupos de formularios */
}

.full-width {
    grid-column: span 2;
}

.button-principal {
    color: var(--color-white); /* USANDO VARIABLE */
    border: none;
    cursor: pointer;
    transition: background-color 0.2s ease-in-out;
    border-radius: 8px; /* AJUSTADO: Bordes m√°s redondeados */
    padding: 12px 20px; /* AJUSTADO: M√°s padding */
    font-size: 16px; /* AJUSTADO: Un poco m√°s grande */
    font-weight: 600; /* AJUSTADO: Seminegrita */
    width: auto;
    display: inline-block;
    margin-right: 10px;
    box-shadow: 0 2px 4px var(--color-shadow-light); /* NUEVO: Sombra suave */
}

.button-principal[id="btnGenerar"] {
    background-color: var(--color-primary); /* USANDO VARIABLE */
}
.button-principal[id="btnGenerar"]:hover {
    background-color: var(--color-primary-dark); /* USANDO VARIABLE */
}

.button-principal[id="btnLimpiar"] {
    background-color: var(--color-secondary); /* USANDO VARIABLE */
}
.button-principal[id="btnLimpiar"]:hover {
    background-color: var(--color-secondary-dark); /* USANDO VARIABLE */
}

#resultado-container {
    margin-top: 20px;
}

#resultado {
    background-color: var(--color-background-medium); /* USANDO VARIABLE */
    padding: 15px; /* AJUSTADO: M√°s padding */
    border-radius: 8px; /* AJUSTADO: M√°s redondeado */
    margin-bottom: 10px; /* AJUSTADO: M√°s espacio */
    font-size: 18px; /* AJUSTADO: Un poco m√°s grande */
    color: var(--color-text-dark); /* USANDO VARIABLE */
    font-weight: bold; /* AJUSTADO: Cambiar de 'bolder' a 'bold' */
}
#resultado p {
    margin: 1px; /* Eliminar m√°rgenes para un dise√±o m√°s limpio */
    margin-block-start: 0px;
    margin-block-end: 0px;
    margin-inline-start: 0px;
    margin-inline-end: 0px;
}
#mensajeCopiado {
    color: var(--color-success); /* USANDO VARIABLE */
    font-weight: 600; /* Negrita para que se vea bien */
    margin-top: 15px;
    text-align: center; /* NUEVO: Para centrar el mensaje de copiado */
}

#resumenVisual {
    background-color: var(--color-background-dark); /* USANDO VARIABLE */
    padding: 20px; /* AJUSTADO: M√°s padding */
    border-radius: 8px; /* AJUSTADO: M√°s redondeado */
    margin-bottom: 20px; /* AJUSTADO: M√°s espacio */
    font-size: 14px;
    color: var(--color-text-medium); /* USANDO VARIABLE */
    box-shadow: 0 2px 8px var(--color-shadow-light); /* NUEVO: Sombra suave */
}

#resumenVisual span {
    display: block;
    margin: 5px 0;
    font-weight: bold; /* Resaltar los valores del resumen */
}

#historial-container {
    margin-top: 30px;
    font-size: 13px;
    color: var(--color-text-light); /* USANDO VARIABLE */
    background-color: var(--color-background-dark); /* USANDO VARIABLE */
    padding: 20px; /* AJUSTADO: M√°s padding */
    border-top: none; /* ELIMINADO: Ya no necesitamos este borde si ponemos sombra */
    border-radius: 8px; /* AJUSTADO: M√°s redondeado */
    display: none;
    text-align: left;
    box-shadow: 0 2px 8px var(--color-shadow-light); /* NUEVO: Sombra suave */
}

#listaHistorial {
    list-style: none;
    padding: 0;
}

#listaHistorial li {
    padding: 8px 0;
    border-bottom: 1px dotted var(--color-border); /* USANDO VARIABLE */
    font-size: 14px;
}

#listaHistorial li:last-child {
    border-bottom: none; /* Eliminar la l√≠nea inferior del √∫ltimo elemento */
}

.toggle-historial {
    background-color: transparent;
    border: none;
    font-size: 14px;
    color: var(--color-primary); /* USANDO VARIABLE */
    margin-top: 20px;
    cursor: pointer;
    text-decoration: underline;
    display: block;
    margin-left: auto;
    margin-right: auto;
    padding: 5px 0;
    font-weight: 600; /* NUEVO: Seminegrita */
}
.toggle-historial:hover {
    color: var(--color-primary-dark); /* USANDO VARIABLE */
}

.marca {
    text-align: center;
    margin-top: 30px;
    font-size: 13px;
    color: #adb5bd;
}

/* Estilos para los links √∫tiles y contactos */
#links-utiles, #contactos-pcs {
    background-color: var(--color-background-dark); /* USANDO VARIABLE */
    padding: 20px; /* AJUSTADO: M√°s padding */
    border-radius: 8px; /* AJUSTADO: M√°s redondeado */
    margin-bottom: 20px; /* AJUSTADO: M√°s espacio */
    font-size: 14px;
    color: var(--color-text-medium); /* USANDO VARIABLE */
    box-shadow: 0 2px 8px var(--color-shadow-light); /* NUEVO: Sombra suave */
}

#links-utiles h3, #contactos-pcs h3 {
    font-size: 18px; /* AJUSTADO: Un poco m√°s grande */
    margin-top: 0;
    color: var(--color-text-dark); /* USANDO VARIABLE */
    margin-bottom: 15px; /* AJUSTADO: M√°s espacio */
}

#links-utiles ul, #contactos-pcs ul {
    padding-left: 20px;
    margin: 0;
    list-style-type: disc; /* Usar vi√±etas est√°ndar */
}

#links-utiles li a {
    color: var(--color-primary); /* USANDO VARIABLE */
    text-decoration: none;
}
#links-utiles li a:hover {
    text-decoration: underline;
    color: var(--color-primary-dark); /* USANDO VARIABLE */
}

/* Estilos para el panel de notas */
#notas-panel {
    width: 100%;
    background-color: var(--color-background-dark); /* USANDO VARIABLE */
    border-top: none; /* ELIMINADO: Ya no necesitamos este borde */
    padding: 20px; /* AJUSTADO: M√°s padding */
    box-shadow: 0 2px 8px var(--color-shadow); /* AJUSTADO: Sombra m√°s pronunciada */
    font-family: 'Segoe UI', 'Helvetica Neue', Arial, sans-serif; /* AJUSTADO: Fuente */
    box-sizing: border-box;
    margin-top: 30px; /* AJUSTADO: M√°s margen superior */
    border-radius: 8px; /* AJUSTADO: M√°s redondeado */
}

#notas-panel h3 {
    margin-top: 0;
    font-size: 18px;
    color: var(--color-text-dark); /* USANDO VARIABLE */
    margin-bottom: 15px; /* AJUSTADO: M√°s espacio */
}

#notas-container {
    margin-top: 10px;
    font-size: 14px;
    max-height: 200px;
    overflow-y: auto;
    border: 1px solid var(--color-border); /* USANDO VARIABLE */
    background-color: var(--color-white); /* USANDO VARIABLE */
    padding: 15px; /* AJUSTADO: M√°s padding */
    border-radius: 6px; /* AJUSTADO: M√°s redondeado */
}

.nota {
    border-bottom: 1px solid var(--color-border); /* USANDO VARIABLE */
    padding-bottom: 10px; /* AJUSTADO */
    margin-bottom: 10px; /* AJUSTADO */
    background: var(--color-white); /* NUEVO: Fondo blanco */
    padding: 10px; /* NUEVO: Padding interno */
    border-radius: 4px; /* NUEVO: Bordes suaves */
    box-shadow: 0 1px 3px var(--color-shadow-light); /* NUEVO: Sombra muy suave */
}
.nota:last-child {
    border-bottom: none;
}

.nota time {
    font-size: 12px;
    color: var(--color-text-light); /* USANDO VARIABLE */
    display: block;
    margin-bottom: 5px;
}

#nueva-nota {
    width: 100%; /* AJUSTADO: Ya con box-sizing es 100% */
    height: 80px;
    margin-bottom: 15px; /* AJUSTADO */
    resize: vertical;
    padding: 12px; /* AJUSTADO */
    border: 1px solid var(--color-border); /* USANDO VARIABLE */
    border-radius: 6px; /* AJUSTADO */
    font-size: 14px;
    box-sizing: border-box; /* Asegurar */
}

#autor {
    width: 100%; /* AJUSTADO: Ya con box-sizing es 100% */
    margin-bottom: 15px; /* AJUSTADO */
    padding: 12px; /* AJUSTADO */
    border: 1px solid var(--color-border); /* USANDO VARIABLE */
    border-radius: 6px; /* AJUSTADO */
    font-size: 14px;
    box-sizing: border-box; /* Asegurar */
}

#guardar-nota {
    width: 100%;
    padding: 12px 20px; /* AJUSTADO */
    background: var(--color-success); /* USANDO VARIABLE */
    color: var(--color-white); /* USANDO VARIABLE */
    border: none;
    border-radius: 8px; /* AJUSTADO */
    cursor: pointer;
    font-size: 16px; /* AJUSTADO */
    font-weight: 600; /* NUEVO */
    transition: background-color 0.2s ease-in-out;
    box-shadow: 0 2px 4px var(--color-shadow-light); /* NUEVO */
}
#guardar-nota:hover {
    background: var(--color-success-dark); /* USANDO VARIABLE */
}

#guardar-nota:hover {
    background: #1e7e34;
}

.selectores {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); /* Hacer los selectores m√°s fluidos */
    gap: 10px;
    margin-bottom: 15px;
}

.full-width[style*="display: flex;"] {
    display: flex;
    gap: 10px; /* Reducir el gap entre los botones */
    align-items:flex-start; /* Alinear verticalmente los botones */
}

.full-width[style*="display: flex;"] .button-principal {
    margin: 0; /* Eliminar m√°rgenes autom√°ticos de los botones en esta secci√≥n */
}


  

   

  #guardar-nota:hover {
    background: #0056b3;
  }

  #alerta_Interpretacion_Detallada {
    font-weight: bold;
    color: #ff0101;
  }

  </style>
  
</head>
<body>
  <div class="container">
<div class="full-width" style="text-align: center;">
    <span class="signature-line">NOC-MO</span>
    <h1>Traductor de Alarmas FMC</h1>
</div>

<div id="herramientas" style="margin-bottom: 20px;">
    <strong>üîß Herramientas:</strong>
    <a href="https://leigto91.github.io/Traductor-de-alarmas/NomenclaturaInfra.html" target="_blank">
        Nomenclatura de Infraestructura
    </a>
</div>
    <div id="contadorAlarmas" class="full-width" style="text-align:center; font-size:12px; color:#555;">‚è≥ Cargando alarmas...</div>

    <div class="form-group">
      <label for="alarmaInput">Alarma FMC:</label>
      <textarea id="alarmaInput" class="form-control" rows="10" placeholder="Pegue aqu√≠ la l√≠nea completa con campos separados por tabulaci√≥n"></textarea>
    </div>
    
    <div class="selectores">
      <label for="afectacion">Tipo de afectaci√≥n:</label>
      <select id="afectacion" class="form-control">
        <option value="AFECTACI√ìN POTENCIAL">AFECTACI√ìN POTENCIAL</option>
        <option value="DEGRADACI√ìN">DEGRADACI√ìN</option>
        <option value="INDISPONIBILIDAD">INDISPONIBILIDAD</option>
        <option value="SIN AFECTACI√ìN">SIN AFECTACI√ìN</option>
      </select>

      <label for="grupo">Grupo asignado:</label>
      <select id="grupo" class="form-control">
        <option value="VOZMOVIL">PCS Voz M√≥vil</option>
        <option value="VOZRESI">PCS Voz Fija</option>
        <option value="ROAMINT">PCS Roaming Internacional</option>
        <option value="VALORAGR">PCS Serv. Convergentes</option>
        <option value="VIRTINFR">PCS Infra&Net</option>
        <option value="NAVMOVIL">PCS Conectividad Afuera</option>
        <option value="PCS-SDB">PCS Se√±alizaci√≥n y BD</option>
        <option value="NOC-AC">NOC-AC</option>
        <option value="NOC-TR">NOC-TR</option>
        <option value="NOC-MO">NOC-MO</option>
        <option value="NCSN-CAO">CSOT</option>
        <option value="BACKEND">BACKEND</option>
        <option value="COMMAND CENTER">COMMAND CENTER</option>
      </select>

      <label for="origen">Origen del reclamo:</label>
      <select id="origen" class="form-control">
        <option value="DIGITAL VIEW">DIGITAL VIEW</option>
        <option value="GRAFANA">GRAFANA</option>
        <option value="MAE Core">MAE Core</option>
        <option value="OPENXPAND">OPENXPAND</option>
        <option value="SMARTCARE">SMARTCARE</option>
        <option value="SOLICITUD">SOLICITUD</option>
        <option value="TEKELEC">TEKELEC</option>        
        <option value="UIM">UIM</option>
      </select>
      <label for="tipo_nodo">Tipo de Nodo:</label>
      <select id="tipo_nodo" class="form-control">
        <option value="MSC">MSC</option>
        <option value="MME/AMF">MME/AMF</option>
        <option value="UGW/DGW/UPF">UGW/DGW/UPF</option>
        <option value="DNS/DEA">DNS/DEA</option>
        <option value="UMG">UMG</option>
        <option value="EDC/CDC">EDC/CDC</option>
        <option value="USSD">USSD</option>        
        <option value="VOICEMAIL">VOICEMAIL</option>
        <option value="OSS">OSS</option>
        <option value="NTR/OTA/WSMS">NTR/OTA/WSMS</option>
        <option value="SMSC">SMSC</option>
        <option value="UDM/USCDB/HSS">UDM/USCDB/HSS</option>
      </select>
    </div>

    <div class="full-width" style="display: flex; gap: 20px;">
      <button style=background-color:#3700ff class="button-principal" id="btnGenerar" onclick="procesarAlarma()" disabled>‚úÖGenerar descripci√≥n</button>
      <button style=background-color:#ff2600 class="button-principal" id="btnLimpiar" onclick="limpiarAlarmaInput()" disabled hidden>üßπ Limpiar alarma</button>
    </div>

    <div class="full-width" style="display: flex; gap: 20px;">
      <!-- Contenedor resultado y resumen -->
      <div id="resultado-container" style="flex: 2;">
        <div id="resultado" style="background-color: #f1f1f1; padding: 10px; border-radius: 8px; margin-bottom: 10px;">
          <p> NOC-MO | Nodo | Alerta_Norm | Tipo de afectaci√≥n | Grupo asignado | Origen del reclamo | Tipo de Nodo</p>
        </div>
        
              <!-- Resumen visual por defecto -->
        <div id="resumenVisual" class="resumen-visual" style="background-color: #f1f1f1; padding: 10px; border-radius: 8px; margin-bottom: 10px;">
          <p>üìç Nodo: <span id="resumenNodo"></span></p>
          <p>üö® Alerta: <span id="resumenAlerta"></span></p>
          <p>üö® Alerta_Norm: <span id="resumenAlertaNorm"></span></p>
          <p>‚ö†Ô∏è Tipo de afectaci√≥n: <span id="resumenAfectacion"></span></p>
          <p>üß© Grupo asignado: <span id="resumenGrupo"></span></p>
          <p>üìù Origen del reclamo: <span id="resumenOrigen"></span></p>
          <p>üìù Info: <span id="resumenInfo"></span></p>
          <p>üìù Info Adicional: <span id="resumenAdicional"></span></p>
          <p>‚è∞ Horario FMC: <span id="resumenHorarioFMC"></span></p>
          <hr>
          <hr>
          <span><strong>Traducci√≥n de alarma:</strong></span>
          <p>üìù T√≠tulo Traducido: <span id="alerta_titulo_corto_resumen"></span></p>
          <p>üìù Interpretaci√≥n Detallada: <span id="alerta_Interpretacion_Detallada"></span></p>
          <div id="linkHedexContainer" style="background-color: #d1ecf1; color: #0c5460; padding: 10px; border-radius: 8px; margin-top: 10px; display: none;">
            <p>üîó Link Hedex: <a id="hedexLink" href="#" target="_blank"></a> (Copiar el link en el mediador)</p>
          </div>
        </div>
      </div>
    
      <!-- Contenedor info adicional -->
      <div id="info-adicional" style="flex: 1; font-size: 12px;">
        <div id="links-utiles" style="background-color: #f1f1f1; padding: 10px; border-radius: 8px; margin-bottom: 10px;">
          <h3 style="font-size: 14px; margin-top: 0;">üîó Links √∫tiles</h3>
          <ul style="padding-left: 18px; margin: 0;">
            <li><a href="http://grafana-teco.telecom.com.ar:3000/d/c0239a12-c598-4291-a18b-01fa48bfc030/estado-de-despliegue-core-5gc?orgId=6" target="_blank">Grafana de Despliegue CORE 5GC</a></li>
            <li><a href="http://grafana-teco.telecom.com.ar:3000/d/b5d6d2e9-3b48-4613-b1fe-56dae6eb2e82/estado-de-servicio-noc-mo?orgId=6&refresh=1m" target="_blank">Grafana de temperaturas</a></li>
            <li><a href="https://pwin0616/consulta_por_CGI.asp" target="_blank">B√∫squeda por TAC</a></li>
            <li><a href="https://automation.telecom.com.ar" target="_blank">TAMBO</a></li>
            <li><a href="https://pwhgmweb1/HGM/Webs/csr2_new.php" target="_blank">HGM</a></li>
            <li><a href="http://10.24.1.150/ingenier@/#/" target="_blank">Ingenier@</a></li>
            <li><a href="https://cablevisionfibertel.sharepoint.com/:x:/r/teams/PCS-Equipo/_layouts/15/doc2.aspx?sourcedoc=%7BEE0B7FCD-14F2-4430-955D-209270FD5AA5%7D&file=InterconexionOperadores%20VPN%20SIP_3.xlsx&fromShare=true&action=default&mobileredirect=true" target="_blank">Rutas SIP</a></li>
            <!-- Agreg√° m√°s si quer√©s -->
          </ul>
        </div>
    
        <div id="contactos-pcs" style="background-color: #f1f1f1; padding: 10px; border-radius: 8px;">
          <h3 style="font-size: 14px; margin-top: 0;">üìß Mails de Contactos principales</h3>
          <ul style="padding-left: 18px; margin: 0;">
            <li>Tech Core: pcs_tech_core@teco.com.ar</li>
            <li>Conectividad Afuera: pcs_conectividad_afuera@teco.com.ar</li>
            <li>Infra&Net: PCS_InfrayNet@teco.com.ar</li>
            <li>Servicios Convergentes: PCSServiciosConvergentes@teco.com.ar</li>
            <li>Servicios Internacionales: PCS_Servicios_Internacionales@teco.com.ar</li>
            <li>Voz Adentro: PCS_Voz_Adentro@teco.com.ar</li>
            <li>Voz Afuera: PCS_Voz_Afuera@teco.com.ar</li>
            <li>SdB: Pcs_sdb@teco.com.ar</li>
            <li>CSOT/CAO: csot_oyp@teco.com.ar</li>
                        <!-- Agreg√° m√°s si quer√©s -->
          </ul>
        </div>
      </div>
    </div>

    <div class="full-width">
      <button class="toggle-historial" onclick="alternarHistorial()">Mostrar/Ocultar historial</button>
      <div id="historial-container">
        <ul id="listaHistorial"></ul>
      </div>
      <button class="toggle-historial" onclick="limpiarHistorial()">üßπ Limpiar historial</button>
    </div>

    <div class="marca full-width">NOC-MO ¬∑ 2025 ¬∑ v1.8 json chatgpt üëà</div>
  </div>

  <script>

  document.addEventListener('DOMContentLoaded', function() {
    document.getElementById('alarmaInput').focus(); // Autofocus al cargar la p√°gina
});

  let alarmas = {};

  // Cargar las alarmas desde el archivo JSON
  fetch('traduccion_alarmas.json')
  .then(response => response.json())
  .then(data => {
    alarmas = {};
    data.forEach(item => {
      alarmas[item.AlarmaOriginal] = {
        T√≠tuloCorto: item.T√≠tuloCorto,
        Interpretaci√≥nDetallada: item.Interpretaci√≥nDetallada
      };
    });
    const total_JSON = Object.keys(alarmas).length;
    document.getElementById("contadorAlarmas").textContent = `‚úÖ ${total_JSON} alarmas cargadas desde la DB`;
    document.getElementById("btnGenerar").disabled = false;
    console.log("Alarmas indexadas:", total_JSON, alarmas);
  })
  .catch(error => {
    console.error("‚ùå Error al cargar el archivo JSON:", error);
    document.getElementById("contadorAlarmas").textContent = "‚ùå Error al cargar las alarmas. Recargue la pagina o verifique el archivo JSON.";
  });
    // Saca los "_esightR21 y _esightR10"
     function limpiarNombreNodo(nodoCrudo) {
     if (!nodoCrudo) return "Nodo vac√≠o o err√≥neo";
     if (nodoCrudo.includes("_eSightR21")) {
     return nodoCrudo.split("_eSightR21")[0];
  } else if (nodoCrudo.includes("_eSightR10")) {
     return nodoCrudo.split("_eSightR10")[0];
  }
     return nodoCrudo;
}
function procesarAlarma() {
    document.getElementById("btnLimpiar").style.display = 'inline-block'; // Asegurar que el bot√≥n limpiar se muestre
    const entrada = document.getElementById("alarmaInput").value;
    const campos = entrada.split('\t');
    
    if (campos.length < 96) {
      alert("‚ö†Ô∏è La l√≠nea debe contener al menos 96 campos separados por tabulaciones. Favor de copiar alarmas con la vista de FMC NOC-MO_CORE");
      return;
    }
    // Variables

    const node = limpiarNombreNodo(campos[52]) || "Nodo vac√≠o o err√≥neo";
    const alarmaOriginal = campos[53] || "Alerta vac√≠a o err√≥nea";
    const info = campos[54] || "Info vac√≠a o err√≥nea";
    // Buscar patr√≥n tipo AABBCCC-DEF123 en el campo "info"
  const regexElementoRed = /[A-Z]{7}-[A-Z]{3}\d{3}/;
  const matchElementoRed = info.match(regexElementoRed);

  if (matchElementoRed) {
    const elementoRed = matchElementoRed[0];
    const urlElementoRed = `NomenclaturaInfra.html?q=${encodeURIComponent(elementoRed)}`;
    window.open(urlElementoRed, '_blank');
  }
    const info_adicional_alerta = campos[55] || "Info vac√≠a o err√≥nea";
    const alerta_norm = campos[56] || "Alerta_Norm vac√≠a o err√≥nea";
    const horarioFMC = campos[60] || "Horario FMC vac√≠o o err√≥neo"; // Nueva variable para First_FMC (√≠ndice 60)

    let hedex = campos[61] || "Campo de AlarmID(Hedex) Vacio o err√≥neo"; // <<-- DEBE SER 'let' aqu√≠
    const gestorFmc = campos[62] || "Campo Gestor en el FMC Vacio o err√≥neo";

    // --- NUEVA L√ìGICA: Limpiar y rellenar HEDEX ---
    if (hedex !== "Campo de AlarmID(Hedex) Vacio o err√≥neo") {
        // Log para verificar qu√© valor tiene 'hedex' ANTES de la asignaci√≥n fallida
        console.log("Tipo de hedex antes de replace:", typeof hedex);
        console.log("Valor de hedex antes de replace:", hedex);

        // 1. Eliminar caracteres no num√©ricos
        hedex = hedex.replace(/\D/g, ''); // <<-- Esta es la l√≠nea 581 que da error

        // Log para verificar qu√© valor tiene 'hedex' DESPU√âS de la asignaci√≥n
        console.log("Valor de hedex despu√©s de replace:", hedex);

        // 2. Rellenar con ceros a la izquierda si la longitud es menor a 4
        if (hedex.length < 4) {
            hedex = hedex.padStart(4, '0');
        }
    }

    const afectacion = document.getElementById("afectacion").value || "Grupo Vac√≠o o en falla";
    const grupo = document.getElementById("grupo").value || "Grupo Vac√≠o o en falla";
    const origen = document.getElementById("origen").value || "Origen Vac√≠o o en falla";
    const tipo_nodo = document.getElementById("tipo_nodo").value || "Origen Vac√≠o o en falla";
  
    // Buscar traducci√≥n en el JSON cargado
    const alerta = alarmas[alerta_norm];

    // se agrega una variable para diferenciar si la alarma se traduce o no, la descripcion se mantiene
    const alerta_titulo_corto = alerta ? alerta.T√≠tuloCorto : alerta_norm;
    //Modificacion para que no aparezca el texto en rojo en el resumen visual
    const alerta_titulo_corto_resumen = alerta ? alerta.T√≠tuloCorto : alerta_norm;
    // const alerta_titulo_corto_resumen = alerta ? alerta.T√≠tuloCorto : alerta_norm +'<span style="color: red;"> üëÜNombre original, traducci√≥n no disponible, informar</span>';
    const alerta_Interpretacion_Detallada = alerta ? alerta.Interpretaci√≥nDetallada : '‚ö†Ô∏è Interpretaci√≥n no disponible';
    
    //armado de la descripci√≥n
    const descripcion = `NOC-MO | ${node} | ${alerta_norm} | ${afectacion} | ${grupo} | ${origen} | ${tipo_nodo}`;
    document.getElementById("resultado").innerText = descripcion;
    document.getElementById("btnLimpiar").disabled = false;
    document.getElementById("btnLimpiar").hidden = false;

    //armado del "ResumenVisual", se agrega del JS al HTML
    function resumenVisual(nodo, alerta, alertaNorm, afectacion, grupo, origen, info, infoAdicional, horarioFMC, alerta_titulo_corto_resumen, alerta_Interpretacion_Detallada) {
      document.getElementById('resumenNodo').textContent = nodo || 'Vacio o en falla';
      // Se modifica para que no aparezca el texto en rojo cuando no hay traduccion en el resumen visual
      // document.getElementById('resumenAlerta').textContent = alerta || '';
      document.getElementById('resumenAlerta').innerHTML = alerta || ''; // Usar innerHTML para el span rojo
      document.getElementById('resumenAlertaNorm').textContent = alertaNorm || '';
      document.getElementById('resumenAfectacion').textContent = afectacion || '';
      document.getElementById('resumenGrupo').textContent = grupo || '';
      document.getElementById('resumenOrigen').textContent = origen || '';
      document.getElementById('resumenInfo').textContent = info || '';
      document.getElementById('resumenAdicional').textContent = infoAdicional || '';
      document.getElementById('resumenHorarioFMC').textContent = horarioFMC || 'Vacio o en falla'; // Asignar el valor de Horario FMC
      document.getElementById('alerta_titulo_corto_resumen').textContent = alerta_titulo_corto_resumen || '';
      document.getElementById('alerta_Interpretacion_Detallada').textContent = alerta_Interpretacion_Detallada || '';
    }

        // --- L√≥gica para el link de Hedex ---

    const linkHedexContainer = document.getElementById("linkHedexContainer");
    const hedexLink = document.getElementById("hedexLink");

    if (gestorFmc === "MC_HUAWEI_U2000_CORE" && hedex && hedex !== "Campo de AlarmID(Hedex) Vacio o err√≥neo" && hedex.length > 0) {
        const urlHedex = `https://10.75.99.169:31943/hedex/search/search.do?q=ALM-${encodeURIComponent(hedex)}`; // Cambia 'https://your-hedex-base-url.com' por la URL real
        hedexLink.href = urlHedex;
        hedexLink.textContent = `${urlHedex}`;
        linkHedexContainer.style.display = 'block'; // Mostrar el contenedor del link
    } else {
        linkHedexContainer.style.display = 'none'; // Ocultar si no cumple la condici√≥n
        hedexLink.href = "#"; // Restablecer el href por si acaso
        hedexLink.textContent = ""; // Limpiar el texto
    }
    resumenVisual(node, alerta_titulo_corto_resumen, alerta_norm, afectacion, grupo, origen, info, info_adicional_alerta, horarioFMC, alerta_titulo_corto_resumen, alerta_Interpretacion_Detallada, linkHedexContainer, hedexLink);

    // -------- ABRIR VENTANA para rutas SIP --------
    if (alerta_norm === "Ruta SIP Caida") {
      const url = `rutas_sip.html?q=${encodeURIComponent(node)}`;
      window.open(url, '_blank');
    }

    // Copiar al portapapeles
    navigator.clipboard.writeText(descripcion).then(() => {
      let mensaje = document.getElementById("mensajeCopiado");
      if (!mensaje) {
        mensaje = document.createElement("div");
        mensaje.id = "mensajeCopiado";
        mensaje.style.color = "green";
        mensaje.style.marginTop = "10px";
        document.getElementById("resultado-container").appendChild(mensaje);
      }
      mensaje.textContent = "‚úÖ Copiado al portapapeles";
      setTimeout(() => mensaje.textContent = "", 10000);
    });
    // A√±adir al historial
    const historialItem = document.createElement("li");
    historialItem.textContent = descripcion;
    document.getElementById("listaHistorial").appendChild(historialItem);
  }
function limpiarAlarmaInput() {
  document.getElementById("alarmaInput").value = "";
  document.getElementById("resultado").innerText = "NOC-MO | Nodo | Alerta_Norm | Tipo de afectaci√≥n | Grupo asignado | Origen del reclamo | Tipo de Nodo";
  // Limpiar espec√≠ficamente el contenido de los spans dentro de resumenVisual
  document.getElementById('resumenNodo').textContent = '';
  document.getElementById('resumenAlerta').textContent = '';
  document.getElementById('resumenAlertaNorm').textContent = '';
  document.getElementById('resumenAfectacion').textContent = '';
  document.getElementById('resumenGrupo').textContent = '';
  document.getElementById('resumenOrigen').textContent = '';
  document.getElementById('resumenInfo').textContent = '';
  document.getElementById('resumenAdicional').textContent = '';
  document.getElementById('resumenHorarioFMC').textContent = '';
  document.getElementById('alerta_titulo_corto_resumen').textContent = '';
  document.getElementById('alerta_Interpretacion_Detallada').textContent = '';
  document.getElementById('linkHedexContainer').style.display = 'none'; // Hace invisible el container de Hedex si se limpia la alarma
  document.getElementById('hedexLink').href = "#";
  document.getElementById('hedexLink').textContent = "";

  document.getElementById("btnLimpiar").style.display = 'none'; // Ocultar el bot√≥n limpiar si el campo est√° vac√≠o
  document.getElementById('alarmaInput').focus(); // Devolver el foco al input despu√©s de limpiar
}

function alternarHistorial() {

      const contenedor = document.getElementById("historial-container");
      const boton = document.querySelector(".toggle-historial");
      const visible = contenedor.style.display === "block";
  
      contenedor.style.display = visible ? "none" : "block";
      boton.textContent = visible ? "Mostrar historial" : "Ocultar historial";
    }
    
    //Lipiar historial
    function limpiarHistorial() {
      document.getElementById("listaHistorial").innerHTML = '';

    document.addEventListener('DOMContentLoaded', function() {
    document.getElementById('alarmaInput').focus();

    // Cargar preferencias guardadas
     const afectacionGuardada = localStorage.getItem('afectacionSeleccionada');
    if (afectacionGuardada) {
        document.getElementById('afectacion').value = afectacionGuardada;
    }

    const grupoGuardado = localStorage.getItem('grupoSeleccionado');
    if (grupoGuardado) {
        document.getElementById('grupo').value = grupoGuardado;
    }

    const origenGuardado = localStorage.getItem('origenSeleccionado');
    if (origenGuardado) {
        document.getElementById('origen').value = origenGuardada;
    }

    const tipoNodoGuardado = localStorage.getItem('tipoNodoSeleccionado');
    if (tipoNodoGuardado) {
        document.getElementById('tipo_nodo').value = tipoNodoGuardado;
    }

    // Guardar preferencias al cambiar la selecci√≥n
    document.getElementById('afectacion').addEventListener('change', function() {
        localStorage.setItem('afectacionSeleccionada', this.value);
    });

    document.getElementById('grupo').addEventListener('change', function() {
        localStorage.setItem('grupoSeleccionada', this.value);
    });

    document.getElementById('origen').addEventListener('change', function() {
        localStorage.setItem('origenSeleccionada', this.value);
    });

    document.getElementById('tipo_nodo').addEventListener('change', function() {
        localStorage.setItem('tipoNodoSeleccionada', this.value);
    });
});
  }
  </script>
  <a href="pruebas.html">‚ö†Ô∏èP√°gina de pruebas‚ö†Ô∏è</a>
  <a href="rutas_sip.html">üìç P√°gina de Rutas SIP </a>
  <p><a href="mailto:LITorres@teco.com.ar,ATDichiara@teco.com.ar?subject=Sugerencias%20traductor%20de%20alarmas
    ">üìùSugerencias o reclamosüìù</a></p>

<!-- Panel de notas </body> -->
<div id="notas-panel">
  <h3>Notas del d√≠a</h3>
  <input type="text" id="autor" placeholder="Tu nombre">
  <textarea id="nueva-nota" placeholder="Escrib√≠ una nota..."></textarea>
  <button id="guardar-nota">Guardar Nota</button>
  <div id="notas-container"></div>
</div>


<script>
  const endpoint = 'https://script.google.com/macros/s/AKfycbygAKi-xhgOtVv_HUNuX4G9ATjsPcfEGVKX0L55Z-PIKK33vz-rEnQ1pzal3LBlnMB4/exec'; // üëà reemplaz√° con tu URL real

  async function cargarNotas() {
    const res = await fetch(endpoint);
    const notas = await res.json();
    const contenedor = document.getElementById("notas-container");
    contenedor.innerHTML = "";

    notas.reverse().forEach(nota => {
      const div = document.createElement("div");
      div.className = "nota";
      div.innerHTML = `<time>${new Date(nota.timestamp).toLocaleString()} - ${nota.autor}</time><div>${nota.nota}</div>`;
      contenedor.appendChild(div);
    });
  }

  async function guardarNota() {
    const nota = document.getElementById("nueva-nota").value.trim();
    const autor = document.getElementById("autor").value.trim() || "An√≥nimo";

    if (nota === "") return;

    await fetch(endpoint, {
      method: "POST",
      body: new URLSearchParams({ nota, autor })
    });

    document.getElementById("nueva-nota").value = "";
    cargarNotas();
  }

  document.getElementById("guardar-nota").addEventListener("click", guardarNota);
  window.addEventListener("load", cargarNotas);
</script>


</body>
</html>